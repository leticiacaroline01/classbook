mg <- gsheet2tbl("https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=983033137#gid=983033137")
mg
micelial <- gsheet2tbl("https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=959387827#gid=959387827")
micelial
dat_mg <- gsheet2tbl("https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=983033137#gid=983033137")
dat_mg
escala <- gsheet2tbl("https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=1729131173#gid=1729131173")
escala
micelial <- gsheet2tbl("https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=959387827#gid=959387827")
micelial
estande <- gsheet2tbl("https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=401662555#gid=401662555")
estande
fungi <- gsheet2tbl("https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=465348652#gid=465348652")
fungi
cr <- gsheet2tbl("https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=1871397229#gid=1871397229")
cr
survey |>
group_by(state, residue) |>
count()
RS <- survey |>
filter(state == "RS")
PR <- survey |>
filter(state == "PR")
combinado <- rbind(RS, PR)
survey_b <- survey |>
dplyr::select(year, state, species)
survey_2009 <- survey |>
dplyr::select(year, state, species) |>
filter(year == 2009)
library(janitor)
survey_b |>
tabyl(year,species)
library(tidyverse)
dat_mg2 <- dat_mg |>
pivot_wider(names_from = trat, values_from = comp) |>
dplyr::select(-"rep")
dat_mg2
data_curva |>
mutate(severity2 = c(1, 10, 35, 58, 70, 79)) |>
ggplot(aes(dates, severity2))+
geom_col()+
#geom_area(fill = "blue")+
geom_line(linewidth = 2, color = "black")+
geom_point(size = 4, color = "black")+
theme_bw(base_size = 14)+
labs(x = "Dia após o plantio",
y = "Severidade (%)")+
scale_y_continuous(limits = c(0, 100), n.breaks = 10) +
scale_x_continuous(n.breaks = 8)
data_curva |>
mutate(severity2 = c(1, 10, 35, 58, 70, 79)) |>
ggplot(aes(dates, severity2))+
geom_col()+
geom_area(fill = "blue")+
geom_line(linewidth = 2, color = "black")+
geom_point(size = 4, color = "black")+
theme_bw(base_size = 14)+
labs(x = "Dia após o plantio",
y = "Severidade (%)")+
scale_y_continuous(limits = c(0, 100), n.breaks = 10) +
scale_x_continuous(n.breaks = 8)
survey_b |>
group_by(year, species) |>
count() |>
ggplot(aes(species,n))+
geom_col()+
facet_wrap(~year)
survey_b |>
group_by(year, species) |>
count() |>
ggplot(aes(year,n, fill = species,
color = species))+
geom_col()+
# scal_fill_manual(values = c("red", "blue"))+
# scale_fill_grey()+
scale_color_viridis_d()
# facet_wrap(~year)
survey_b |>
group_by(year, species) |>
count() |>
ggplot(aes(year,n, fill = species,
color = species))+
geom_col()+
scale_fill_manual(values = c("red", "blue"))+
# scale_fill_grey()+
scale_color_viridis_d()
# facet_wrap(~year)
survey_b |>
group_by(year, species) |>
count() |>
ggplot(aes(year,n, fill = species,
color = species))+
geom_col()+
# scal_fill_manual(values = c("red", "blue"))+
scale_fill_grey()+
scale_color_viridis_d()
# facet_wrap(~year)
survey_b |>
group_by(year, species) |>
count() |>
ggplot(aes(year,n, fill = species,
color = species))+
geom_col()+
# scal_fill_manual(values = c("red", "blue"))+
# scale_fill_grey()+
scale_color_viridis_d()+
facet_wrap(~year)
library(ggthemes)
plot_mg <- mg |>
ggplot(aes(trat, comp))+
geom_boxplot(fill = "grey",
outlier.colour = NA)+
geom_jitter(width = 0.1, color = "grey20")+
scale_y_continuous(limits = c(5,20))+
labs(x = "Tratamento",
y = "Comprimento (mm)")+
theme_minimal()
plot_mg
ggsave("box.png", bg = "white", width = 5,
height = 5)
plot_micelial <- micelial |>
ggplot(aes(reorder(especie, tcm),tcm))+
geom_boxplot(fill = "darkgreen",
outlier.colour = NA)+
geom_jitter(width = 0.1, color = "grey20")+
scale_y_continuous(limits = c(0,2))+
labs(x = "", y = "Taxa de crescimento micelial (mm/dia)")+
theme_minimal()+
coord_flip()
plot_micelial
dat_mg
dat_mg |>
ggplot(aes(trat,comp))+
geom_jitter(width = 0.1)
library(ggpubr)
p <- ggboxplot(
dat_mg, x = "trat", y = "comp",
color = "trat", palette = "jco")
p
library(rstatix)
test <- t_test(comp ~ trat, data = dat_mg)
test
p + stat_pvalue_manual(test, label = "p",
y.position = 18)+
ylim(0,20)+
labs(x = "Tratamento",
y = "Comprimento da lesão (mm)")
library(patchwork)
(plot_mg | plot_micelial) +
plot_annotation(tag_levels = "a")
ggsave("box.png", bg = "white", width = 5,
height = 5)
ggsave("comb.png", bg = "white",
width = 8, height = 4)
ggsave("plot2.png", bg = "white")
attach(dat_mg2)
t_results <- t.test(control, Mg2,
var.equal = FALSE)
library(report)
report(t_results)
library(rstatix)
test <- t_test(comp ~ trat, data = dat_mg)
test
shapiro.test(Mg2)
shapiro.test(control)
hist(dat_mg2$Mg2)
hist(control)
var.test(dat_mg2$Mg2,
dat_mg2$control)
escala
t_test(acuracia ~ assessment,
data = escala,
paired = TRUE)
escala |>
ggplot(aes(assessment, acuracia))+
geom_boxplot()
micelial
micelial |>
ggplot(aes(especie, tcm))+
geom_boxplot(oulier.colour = NA)+
geom_jitter(width = 0.1)
anova1 <- aov(tcm ~especie, data = micelial)
anova1
anova2 <- lm(tcm ~ especie, data = micelial)
anova2
anova(anova1)
anova(anova2)
hist(residuals(anova1))
hist
shapiro.test(residuals(anova1))
bartlett.test(tcm ~ especie, data = micelial)
levene_test(tcm ~ especie, data = micelial)
library(emmeans)
m <- emmeans(anova2, ~ especie)
m
library(multcomp)
library(multcompView)
cld(m)
pairs(m)
pwpm(m)
insetos <- InsectSprays
insetos
insetos |>
ggplot(aes(spray, count))+
geom_boxplot(outlier.colour = NA)+
geom_jitter(width = 0.1)
bartlett.test(sqrt(count) ~ spray, data = insetos)
m2 <- lm(sqrt(count) ~ spray, data = insetos)
m2
hist(residuals(m2))
shapiro.test(residuals(m2))
qqnorm(residuals(m2))
qqnorm(residuals(m2))
qqline(residuals(m2))
library(performance)
check_model(m2)
library(DHARMa)
m2
plot(simulateResiduals(m2))
m3 <- lm(sqrt(count) ~ spray, data = insetos)
m3
hist(residuals(m3))
shapiro.test(residuals(m3))
qqnorm(residuals(m3))
anova(m3)
m33 <- emmeans(m3, ~spray, type = "response")
m33
cld(m33)
plot(m33)
library(MASS)
insects <- InsectSprays
m1 <- lm(count ~ spray, data = insects)
library(DHARMa)
plot(simulateResiduals(m1))
boxcox(lm(insects$count + 0.1 ~ 1))
b <- boxcox(lm(insects$count + 0.1 ~ 1))
lambda <- b$x[which.max(b$y)]
lambda
library(tidyverse)
Insects <- insects |>
mutate(count = as.numeric(count),
count3 = sqrt(count))
Insects
insects$count2 <- (insects$count ^ lambda - 1) / lambda
hist(insects$count)
kruskal.test(count ~ spray, data = insetos)
library(rstatix)
kruskal_test(insetos, count ~spray)
library(agricolae)
kruskal(insetos$count, insetos$spray, group = TRUE,
console = TRUE)
m4 <- glm(count ~ spray, data = insetos,
family = poisson)
m4
anova(m4)
library(car)
Anova(m4)
library(DHARMa)
plot(simulateResiduals(m4))
medias_m4 <- emmeans(m4, ~ spray, type = "response")
medias_m4
library(multcomp)
library(multcompView)
cld(medias_m4)
antifungicos
interaction.plot(antifungicos$treat, antifungicos$dose, antifungicos$severity)
p1 <- antifungicos |>
ggplot(aes(factor(dose), severity*100))+
geom_jitter(width = 0.1)
p1
p2 <- antifungicos |>
ggplot(aes(factor(treat), severity*100))+
geom_jitter(width = 0.1)
library(ggplot2)
antifungicos |>
ggplot(aes(factor(dose), severity*100))+
geom_jitter(width = 0.1)+
facet_wrap(~ treat)
m_anti <- lm(severity ~ treat*dose, data = antifungicos)
m_anti
anova(m_anti)
library(DHARMa)
plot(simulateResiduals(m_anti))
library(emmeans)
media_anti <- emmeans(m_anti, ~ dose | treat)
media_anti
cld(media_anti)
library(agricolae)
cv.model(m_anti)
library(epifitter)
oidio <- PowderyMildew
oidio
library(ggplot2)
oidio |>
ggplot(aes(factor(time), sev))+
geom_jitter(width = 0.1)+
facet_wrap(~ irrigation_type)
oidio2 <- oidio |>
dplyr::filter(irrigation_type %in% c("MS", "MS above canopy",
"Overhead"))
oidio2
oidio2 |>
ggplot(aes(time, sev))+
geom_point()+
facet_grid(moisture ~ irrigation_type)
oidio2
oidio3 <- oidio2 |>
group_by(irrigation_type, moisture, block) |>
summarize(AUDPC = AUDPC(time, sev), .groups = "drop")
oidio3
oidio3 |>
ggplot(aes(irrigation_type,
AUDPC, color = moisture))+
geom_point(size = 2)+
scale_y_continuous(limits = c(0,20))
model_oidio <- lm(AUDPC ~ irrigation_type * moisture,
data = oidio3)
model_oidio
anova(model_oidio)
plot(simulateResiduals(model_oidio))
medias_oidio <- emmeans(model_oidio, ~ irrigation_type | moisture)
medias_oidio
cld(medias_oidio)
cv.model(model_oidio)
campo
cor(campo$FER, campo$PROD)
cor.test(campo$FER, campo$DFC)
campo |>
ggplot(aes(FER, DFC))+
geom_point()+
geom_smooth(method = "lm")
campo |>
mutate(TRAT = factor(TRAT)) |>
ggplot(aes(TRAT, PROD))+
geom_jitter(widht = 0.1)+
stat_summary(
fun.data = "mean_cl_boot",
colour = "red", width = 0.3
)
campo$TRAT <- factor(campo$TRAT)
campo$TRAT
campo$BLOCO <- factor(campo$BLOCO)
campo$BLOCO
m_campo <- lm(log(FER) ~ BLOCO + TRAT, data = campo)
m_campo
anova(m_campo)
library(DHARMa)
plot(simulateResiduals(m_campo))
means_campo <- emmeans(m_campo, ~ TRAT, type = "response")
means_campo
library(agricolae)
cv.model(m_campo)
plot(means_campo)
library(multcomp)
cld(means_campo)
pwpm(means_campo)
milho
milho |>
ggplot(aes(hybrid, index, color = method))+
geom_jitter(widht = 0.1)+
coord_flip()
milho$hybrid_block <- interaction(milho$hybrid, milho$block) #interação entre o hibrido e bloco
milho$hybrid_block
milho |>
mutate(hybrid_block = interaction(hybrid, block)) # fator único entre hibrido e bloco - uma coluna
library(lme4)
m_milho <- lmer(index ~ hybrid*method +
(1| block:hybrid_block),
data = milho)
car::Anova(m_milho)
plot(simulateResiduals(m_milho))
media_milho <- emmeans(m_milho, ~ method | hybrid)
cld(media_milho, Letters = letters)
m_milho3 <- lmer(yield ~ hybrid*method +
(1| block:hybrid_block),
data = milho)
plot(simulateResiduals(m_milho3))
media_milho3 <- emmeans(m_milho3, ~ hybrid | method)
media_milho3
cld(media_milho3, Letters = letters)
milho |>
ggplot(aes(index, yield))+
geom_point()+
geom_smooth(method = "lm")
cor1 <- cor(milho$index, milho$yield)
cor1*cor1*100
cor.test(milho$index, milho$yield)
estande
library(ggplot2)
estande |>
ggplot(aes(trat,nplants))+
geom_point(color = "gray")+
geom_smooth(method = "lm", se = FALSE,
color = "black")+
facet_wrap(~ exp)+
theme_minimal()+
labs(x = "% de inóculo na semente",
y = "Número de plantas")
exp1 <- estande |>
filter(exp == 1)
m_exp1 <- lm(nplants ~ trat + bloco, data = exp1)
summary(m_exp1)
exp2 <- estande |>
filter(exp == 2)
m_exp2 <- lm(nplants ~ trat, data = exp2)
summary(m_exp2)
exp3 <- estande |>
filter(exp == 3)
m_exp3 <- lm(nplants ~ trat, data = exp3)
summary(m_exp3)
library(lme4)
m_misto <- lmer(nplants ~ trat + (1 | exp/bloco), data = estande)
confint(m_misto)
summary(m_misto)
library(car)
car::Anova(m_misto)
estande |>
ggplot(aes(trat, nplants, color = factor(exp)))+
geom_point()+
# geom_smooth(method = "lm", se = FALSE)+
geom_abline(intercept = 69.74,
slope = -0.568, linewidth = 2)+
geom_abline(intercept = 43,
slope = -0.73, linetype = "dashed")+
geom_abline(intercept = 96,
slope = -0.40, linetype = "dashed")
fungi
fungi |>
group_by(code, dose) |>
summarise(germination = mean(germination)) |>
ggplot(aes(dose, germination))+
geom_point()+
geom_line()+
# geom_smooth(se = FALSE)+
facet_wrap(~ code)
FGT43 <- fungi |>
group_by(code, dose) |>
summarise(germination = mean(germination)) |>
filter(code == "FGT43")
library(drc)
m43 <- drm(germination ~ dose,
data = FGT43,
fct = LL.3())
summary(m43)
AIC(m43)
plot(m43)
ED(m43,50)
library(ec50estimator)
df_ec50 = estimate_EC50(germination ~ dose,
data = fungi,
isolate_col = "code",
strata_col = "state",
interval = "delta",
fct = drc::LL.3())
df_ec50
df_ec50 |>
ggplot(aes(reorder(ID, Estimate), Estimate))+
geom_point()+
coord_flip()
df_ec50 |>
ggplot(aes(x = Estimate))+
geom_histogram(bins = 5, color = "white")
library(gsheet)
library(DT)
datatable(cr)
cr
library(DT)
datatable(cr)
library(tidyverse)
cr |>
ggplot(aes(lon, lat))+
geom_point()
library(rnaturalearth)
library(remotes)
#remotes::install_github("ropensci/rnaturalearthhires")
ETH <- ne_states(country = "Ethiopia",
returnclass = "sf")
#ETH <- ne_states(coutry = "Brasil",
# returnclass = "sf")
## PARA CRIAR SHAP DO BRASIL -  CORTAR
library(tidyverse)
ETH |>
ggplot() +
geom_sf(fill = "white") +
geom_point(data = cr, aes(lon, lat, color = inc)) +
scale_color_viridis_c()+
theme_void()
library(ggthemes)
library(ggspatial)
ETH |>
ggplot() +
geom_sf(fill = "white") +
geom_point(data = cr, aes(lon, lat, color = inc)) +
scale_color_viridis_c() +
theme_map()
library(ggspatial)
mapa <- ETH |>
ggplot() +
geom_sf(fill = "gray90") +
geom_point(data = cr, aes(lon, lat, color = inc)) +
scale_color_viridis_c() +
theme_minimal() +
theme(legend.position = "bottom") +
annotation_scale(location = "tl") +
annotation_north_arrow(location = "br", which_north = "true") +
labs(title = "ferrugem do café na Etiópia",
x = "longitude", y = "latitude",
subtitle = "Levantamento em fazendas",
caption = "Fonte: Del Ponte et al. (2025",
color = "Incidência(%)")
ggsave("mapa_etiopia.png", bg = "white", width = 10)
#ggsave("mapa_etiopia.pdf", bg = "white", width = 10)
